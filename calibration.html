<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Calibration &mdash; WaTEM/SEDEM  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Summary ini-file" href="inifile.html" />
    <link rel="prev" title="Model output" href="output.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            WaTEM/SEDEM
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="model.html">Model Description</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="usage.html">Model Usage</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="rasterinfo.html">Rasters</a></li>
<li class="toctree-l2"><a class="reference internal" href="choices.html">Model Choices</a></li>
<li class="toctree-l2"><a class="reference internal" href="model_extensions.html">Model extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="input.html">Model input</a></li>
<li class="toctree-l2"><a class="reference internal" href="output.html">Model output</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Calibration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#theoretical-background">Theoretical background</a></li>
<li class="toctree-l3"><a class="reference internal" href="#practical-execution">Practical execution</a></li>
<li class="toctree-l3"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="inifile.html">Summary <code class="docutils literal notranslate"><span class="pre">ini</span></code>-file</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Contact</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">WaTEM/SEDEM</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="usage.html">Model Usage</a></li>
      <li class="breadcrumb-item active">Calibration</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/watem-sedem/watem-sedem/blob/master/docs/calibration.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="output.html" class="btn btn-neutral float-left" title="Model output" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="inifile.html" class="btn btn-neutral float-right" title="Summary ini-file" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="calibration">
<span id="id1"></span><h1>Calibration<a class="headerlink" href="#calibration" title="Permalink to this heading"></a></h1>
<p>This chapter describes the calibration of <a class="reference internal" href="watem-sedem.html#ws"><span class="std std-ref">WaTEM/SEDEM</span></a>. In an efficient
and semi-automated way.</p>
<div class="section" id="theoretical-background">
<h2>Theoretical background<a class="headerlink" href="#theoretical-background" title="Permalink to this heading"></a></h2>
<p>WaTEM/SEDEM can be calibrated for a specific study area by comparing the
calculated sediment fluxes to the rivers with the observed sediment fluxes in
a number of catchments. For every catchment in the calibration dataset an
observed/measured sedimentflux must be present.
In the model, only the ktc parameters can be choosen freely,
and thus be used as calibration parameter.
The ktc values only affect the <a class="reference internal" href="choices.html#tcmodel"><span class="std std-ref">transport capacity</span></a> (TC)
calculated by the WaTEM/SEDEM model.
Therefor, this parameter can be adapted in order to calibrate the model.</p>
<p>In the model runs, two ktc values are used, namely: ktc-low and ktc-high.
The first value, ktc-low, is used for land covers with low erosion potential
(i.e. forest, pasture and grass strips), the latter, ktc-high, is used for land
covers with high erosion potential (i.e. agricultural fields). Land covers with
no erosion potential (i.e. infrastructure, rivers and open water) are
automatically appointed with a very high ktc value (i.e. 9999).</p>
<p>In order to select the correct ktc values for a specific study area,
WaTEM/SEDEM must be ran for a range of ktc values for all measurement areas in
the dataset. The optimal combination of both ktc values is obtained by evaluating three
criteria. This evaluation is done by the modeler in an external analysis and is not
in the scope of this documentation.</p>
<p>The first criterium in the selection process is the calculation of the
model efficiency <span class="math notranslate nohighlight">\(ME\)</span>, defined by Nash and Sutcliffe (1970) as:</p>
<div class="math notranslate nohighlight">
\[ME = 1 - \frac{\sum_{i}^{n}(E_{obs,i}-E_{sim,i})^2}{\sum_{i}^{n}(E_{obs,i}-E_{avg})^2}\]</div>
<p>with</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{obs,i}\)</span>: the observed sediment export for measurement point <span class="math notranslate nohighlight">\(i\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(E_{sim,i}\)</span>: the simulated sediment export for measurement point <span class="math notranslate nohighlight">\(i\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(E_{avg}\)</span>: the average observed sediment export of all <span class="math notranslate nohighlight">\(n\)</span> measurement points</p></li>
</ul>
<p>The observed sediment export is typically determined by field measurements.
In these field measurements, the total sediment load for an event and/or a total year is
determined. It is important to note that the observations from the field measurements
should be processed (by the user) in a way they are representative for the sediment load
simulated by WaTEM/SEDEM. The simulated sediment load is the simulated load at a pixel
(cfr. SediExport-raster) overlapping with the location of field measurements.</p>
<p>Model efficiencies can vary between <span class="math notranslate nohighlight">\(-\infty\)</span>  and 1. An <span class="math notranslate nohighlight">\(ME\)</span> value smaller than
zero means that the model is not efficient, i.e. the model delivers a result
that is less accurate than the mean value of the observed values. An <span class="math notranslate nohighlight">\(ME\)</span> value
of 1 can be interpreted as perfect model.</p>
<p>All calculated <span class="math notranslate nohighlight">\(ME\)</span> values for the different ktc-combinations can be visualised
in a plot as shown by Van Rompaey et al. (2001).</p>
<div class="figure align-center" id="id2">
<a class="reference internal image-reference" href="_images/plot_ME_calibration.png"><img alt="_images/plot_ME_calibration.png" src="_images/plot_ME_calibration.png" style="width: 300px;" /></a>
<p class="caption"><span class="caption-text">Model efficiencies for different combinations of ktc-low and ktc-high (Van Rompaey et al., 2001)</span><a class="headerlink" href="#id2" title="Permalink to this image"></a></p>
</div>
<p>Model simulations with a combination of ktc values with a high <span class="math notranslate nohighlight">\(ME\)</span> value are then
further analysed. In the second criterium, the slope of the linear regression (with intercept 0)
between the observed and simulated values is being analyzed. The simulated sediment export is considered
‘good’ if the calculated slope lies between 0.95 and 1.05. If not, the
bias between model result and observation is considered too high (i.e. systematically more
than 5% too high or too low).</p>
<p>It should be noted, however, that in areas with a predominant
land cover (e.g. dominant cropland), only one ktc-value if often calibrated with
a high ME, whilst the ME vs KTC-graph for the other value is rather flat (see also image above).
In that case, a third and last criterium can be used, which examines the ratio between
ktc-low and ktc-high. Multiple calibrations using different
input data for river catchments in Flanders, Belgium, showed that this ratio typically
lies between 0.25 and 0.35. Verstraeten et al. (2006) showed that when a ratio in
this range is used, the simulated effect of grass buffer strips is regarded to be equal
to the measured effectiveness of this type of erosion control measure,
thus showing that the model is capable of predicting the impact of this type of soil and
water conservation measure whereby differences in vegetation cover are crucial.
However, in other environments, where the contrast in erosion potential between vegetated
and non-vegetated land use classes is different compared to that between cropland and
grassland/forest in a temperate region like Belgium,
a different ratio between ktc-high and ktc-low can be sought for.
Local insights into the different erosion potential may help in this respect.</p>
</div>
<div class="section" id="practical-execution">
<h2>Practical execution<a class="headerlink" href="#practical-execution" title="Permalink to this heading"></a></h2>
<p>WaTEM/SEDEM has a built-in calibration tool. This tool is an extenstion develloped
during the work of Deproost et al. (2018). To use this tool, the user has to
create a set of input rasters for every catchment in the calibration dataset and
has to define all the <a class="reference internal" href="choices.html#choicespage"><span class="std std-ref">options</span></a> that are needed for the
calibration and the future model runs. In the ini-file for every catchment that should
be calibrated, the user
has to enable the <a class="reference internal" href="model_extensions.html#calibrate"><span class="std std-ref">calibration option</span></a> and define the
<a class="reference internal" href="input.html#calibrationparamters"><span class="std std-ref">range of ktc values</span></a>.</p>
<p>The model will then loop over all combinations of ktc values in the defined range.
First, a <a class="reference internal" href="input.html#ktcmap"><span class="std std-ref">ktc map</span></a> is created by the model for every ktc combination.
Next, the full WaTEM/SEDEM model is run for all these combinations, for all the given
catchments. Finally, a <a class="reference internal" href="output.html#calibrationtxt"><span class="std std-ref">calibration file</span></a> with the amount of
sediment at each outlet of the model, for each combination of ktc values in the defined
range is available for every catchment. These
files can be processed by the user, through e.g. a python script, to calculate the <span class="math notranslate nohighlight">\(ME\)</span> and
the other criteria, mentioned above, in order to select the best set of ktc-values for the study area.</p>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this heading"></a></h2>
<p>Deproost, P., Renders, D., Van de Wauw, J., Van Ransbeeck, N.,
Verstraeten, G., 2018, Herkalibratie van WaTEM/SEDEM met het DHMV-II als
hoogtemodel: eindrapport. Brussel. (in Dutch)
<a class="reference external" href="https://archief.onderzoek.omgeving.vlaanderen.be/Onderzoek-1812384">https://archief.onderzoek.omgeving.vlaanderen.be/Onderzoek-1812384</a></p>
<p>Nash, J. E.; Sutcliffe, J. V. (1970). “River flow forecasting through conceptual
models part I — A discussion of principles”. Journal of Hydrology. 10 (3):
282–290. <a class="reference external" href="https://doi.org/10.1016/0022-1694(70)90255-6">https://doi.org/10.1016/0022-1694(70)90255-6</a></p>
<p>Verstraeten, G., Poesen, J., Gillijns, K., &amp; Govers, G. (2006). The use of
riparian vegetated filter strips to reduce river sediment loads: an overestimated
control measure?. Hydrological Processes: An International Journal,
20(20), 4259-4267. <a class="reference external" href="https://doi.org/10.1002/hyp.6155">https://doi.org/10.1002/hyp.6155</a></p>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="output.html" class="btn btn-neutral float-left" title="Model output" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="inifile.html" class="btn btn-neutral float-right" title="Summary ini-file" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, KU Leuven &amp; Fluves, see https://watem-sedem.github.io/watem-sedem/authors.html for more information.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>