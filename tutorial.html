<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tutorial &mdash; cn-ws  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Frequently Asked Questions" href="faq.html" />
    <link rel="prev" title="Installation" href="installation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            cn-ws
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="model.html">Model Description</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Model Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#getting-started">0. Getting started</a></li>
<li class="toctree-l2"><a class="reference internal" href="#a-basic-model-run-with-watem-sedem">1. A basic model run with WaTEM/SEDEM</a></li>
<li class="toctree-l2"><a class="reference internal" href="#get-more-model-output">2. Get more model output!</a></li>
<li class="toctree-l2"><a class="reference internal" href="#adding-buffer-basins">3. Adding buffer basins</a></li>
<li class="toctree-l2"><a class="reference internal" href="#use-the-cn-module">4. Use the CN module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#more-examples">5. More examples?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Contact</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">cn-ws</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Tutorial</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/cn-ws/cn-ws/blob/master/docs/tutorial.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="installation.html" class="btn btn-neutral float-left" title="Installation" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="faq.html" class="btn btn-neutral float-right" title="Frequently Asked Questions" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="tutorial">
<span id="id1"></span><h1>Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this heading"></a></h1>
<p>In this tutorial we will give a short overview on how the CN-WS model can be configured for practical use.
On the one hand, we will explain how the configuration file (<code class="docutils literal notranslate"><span class="pre">.ini</span></code>-file) should be made, and on the other hand, how the prefered model options are enabled or
disabled.</p>
<div class="section" id="getting-started">
<h2>0. Getting started<a class="headerlink" href="#getting-started" title="Permalink to this heading"></a></h2>
<p>First of all, an installation of a simple text editor like <a class="reference external" href="https://notepad-plus-plus.org/">notepad++</a> is needed
in order to edit the configuration file (<code class="docutils literal notranslate"><span class="pre">.ini</span></code>-file). A GIS program is needed as well to create the necessary input rasters and to view the output rasters. We recommend
<a class="reference external" href="https://www.qgis.org">QGIS</a> or <a class="reference external" href="http://www.saga-gis.org/">Saga GIS</a>. In this
tutorial we will not explain how to use GIS, nor how to make the
input rasters, these are basic GIS-tasks and these are explained in several
tutorials online. We encourage readers to start the tutorial by using
the tutorial_1.ini file, and adapt this file according to the exercise. This file can be found on the github page of CN-WS, under the folder: <a class="reference external" href="https://github.com/cn-ws/cn-ws/tree/master/docs/tutorials">docs/tutorials</a>. The
other tutorial ini-files in the tutorials folder can be used to check your
adaptations.</p>
<p>Then, you need to download the latest release of the model. Pre-build binaries
exist for windows and linux. It is also possible to build the model from source.
See <a class="reference internal" href="installation.html#install"><span class="std std-ref">the installation page</span></a> for more information.</p>
<p>All example model runs described below make use of the test dataset which is
available in the repository under <a class="reference external" href="https://github.com/cn-ws/cn-ws/tree/master/testfiles/molenbeek">testfiles/molenbeek/modelinput</a>.</p>
</div>
<div class="section" id="a-basic-model-run-with-watem-sedem">
<span id="tutsection1"></span><h2>1. A basic model run with WaTEM/SEDEM<a class="headerlink" href="#a-basic-model-run-with-watem-sedem" title="Permalink to this heading"></a></h2>
<p>As a first exercise in the tutorial we will make a basic model run with the
WaTEM/SEDEM module of CN-WS. The basic model run includes only mandatory input files.
This run does not use advanced <a class="reference internal" href="usage.html#usage"><span class="std std-ref">model options</span></a>. All
keywords used in an ini-file are explained in the <a class="reference internal" href="usage.html#usage"><span class="std std-ref">reference</span></a>.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[Working directories]</span>
<span class="na">input directory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">../testfiles/molenbeek/modelinput/</span>
<span class="na">output directory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">../testfiles/molenbeek/modeloutput_tutorial_1/</span>

<span class="k">[Files]</span>
<span class="na">dtm filename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">dtm.rst</span>
<span class="na">p factor map filename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">P_molenbeek.rst</span>
<span class="na">parcel filename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">perceelskaart_2018_molenbeek_s1.rst</span>
<span class="na">c factor map filename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">C_spring_2018_molenbeek_s1.rst</span>
<span class="na">k factor filename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">K3_CNWS_molenbeek.rst</span>

<span class="k">[User Choices]</span>
<span class="na">only WS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1</span>
<span class="na">use r factor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1</span>

<span class="k">[Variables]</span>
<span class="na">ktc low</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">3</span>
<span class="na">ktc high</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">12</span>
<span class="na">ktc limit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">0.01</span>
<span class="na">parcel connectivity cropland</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">90</span>
<span class="na">parcel connectivity forest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">30</span>
<span class="na">parcel trapping efficiency cropland</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">0</span>
<span class="na">parcel trapping efficiency forest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">75</span>
<span class="na">parcel trapping efficiency pasture</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">75</span>
<span class="na">bulk density</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1350</span>
<span class="na">r factor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1250</span>
</pre></div>
</div>
<p>After navigating to the folder where you have build the model, or installed the binary, you can
use your terminal to run the model, as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>cn_ws<span class="w"> </span><span class="s2">&quot;&lt;path to cn-ws repository&gt;/cn_ws/docs/tutorials/tutorial_1.ini&quot;</span>
</pre></div>
</div>
<p>When the model run starts you will see:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CN_WS</span> <span class="n">model</span>

<span class="n">Inifile</span> <span class="p">:</span> <span class="o">&lt;</span><span class="n">path</span> <span class="n">to</span> <span class="n">cn</span><span class="o">-</span><span class="n">ws</span> <span class="n">repository</span><span class="o">&gt;/</span><span class="n">cn_ws</span><span class="o">/</span><span class="n">docs</span><span class="o">/</span><span class="n">tutorials</span><span class="o">/</span><span class="n">tutorial_1</span><span class="o">.</span><span class="n">ini</span>
</pre></div>
</div>
<p>After the completion of the calculations, the model reports the execution time:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Calculations</span> <span class="n">completed</span><span class="o">.</span> <span class="n">Program</span> <span class="n">Execution</span> <span class="n">Time</span><span class="p">:</span> <span class="mf">5.96</span> <span class="n">sec</span>
</pre></div>
</div>
<p>Now, you can have a look in the model output folder defined in the ini-file. A
txt-file with a summary of the results is written:
<a class="reference internal" href="output.html#totalsedimenttxt"><span class="std std-ref">Total sediment.txt</span></a>.</p>
<div class="highlight-vim notranslate"><div class="highlight"><pre><span></span>Total erosion: <span class="m">-22676167</span>.<span class="m">77</span> <span class="p">(</span>kg<span class="p">)</span>
Total deposition: <span class="m">18978534</span>.<span class="m">3</span> <span class="p">(</span>kg<span class="p">)</span>
Sediment leaving the catchment<span class="p">,</span> via the river: <span class="m">3268806</span>.<span class="m">66</span> <span class="p">(</span>kg<span class="p">)</span>
Sediment leaving the catchment<span class="p">,</span> not via the river: <span class="m">419793</span>.<span class="m">77</span> <span class="p">(</span>kg<span class="p">)</span>
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

Total sediment passing at each outlet [kg]
Outlet ID	Sediment
<span class="m">1</span>	<span class="m">3268804</span>.<span class="m">75</span>
</pre></div>
</div>
<p>This table contains the sum of all pixels with a negative mass balance (Total
erosion) and a positive mass balance (total deposition). A negative mass balance
means that the available sediment (RUSLE + SediIn) in a pixel is smaller than the
transport capacity, and thus leads to a net erosion in this pixel. A positive mass balance means that the available sediment in
the pixel is larger than the transport capacity, and thus leads to a net sedimentation in this pixel. We refer to the
<a class="reference internal" href="watem-sedem.html#concept"><span class="std std-ref">WaTEM/SEDEM section</span></a> where these concepts are explained more in
depth.</p>
<p>The total sediment table also reports how
much sediment enters the river pixels (Sediment leaving the catchment, via the
river). The sediment leaving the catchment, not via the river is (mostly) a small
fraction of the sediment that leaves the catchment via the borders (to nodata pixels).</p>
<p>In the ini-file of this tutorial we have not defined any outlets
(<a class="reference internal" href="choices.html#manualoutlet"><span class="std std-ref">Manual outlet selection = 0</span></a>). Therefore, the
model made an outlet itself: the model looked for the lowest (river) pixel treated
in the routing algorithm. If you have a look in the model input folder, you will see
that <a class="reference internal" href="input.html#outletmap"><span class="std std-ref">Outlet.rst</span></a> appeared. All pixels in this raster have
value ‘0’ except one pixel with value 1. This pixel is the outlet of the model.</p>
<p>Congratulations! You just finished your first model calculation with CN-WS!</p>
</div>
<div class="section" id="get-more-model-output">
<h2>2. Get more model output!<a class="headerlink" href="#get-more-model-output" title="Permalink to this heading"></a></h2>
<p>The first tutorial described a very basic model run: only
<a class="reference internal" href="output.html#totalsedimenttxt"><span class="std std-ref">a txt file</span></a> with a summary of the results is written as
output. If we want spatial information about where erosion and sedimentation
occurs, we can enable <a class="reference internal" href="output.html#modeloutput"><span class="std std-ref">various output options</span></a>. Therefore,
we need to add a section in the ini-file with the desired output:
<a class="reference internal" href="choices.html#writesedexport"><span class="std std-ref">write sediment export</span></a> and
<a class="reference internal" href="choices.html#writerwatereros"><span class="std std-ref">write water erosion</span></a>.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[Output maps]</span>
<span class="na">write sediment export</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1</span>
<span class="na">write water erosion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1</span>
</pre></div>
</div>
<p>To do so, you can make a copy of the <cite>tutorial_1.ini</cite>-file in a directory
of your choice, adapt the ini-file with the lines stated above, and rename the file to ‘tutorial_2.ini’.
Then the adapted model can be ran using
.. code-block:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cn_ws $your_favorite_folder/tutorial_2.ini
</pre></div>
</div>
<p>If this is not working as it should, please check if the reference
‘<cite>your_favorite_folder</cite>’ is the folder where you saved the <cite>tutorial_2.ini</cite>-
file. If unsure, you can always check and run the reference <cite>tutorial_2
.ini</cite>-file present in the repository with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cn_ws</span> <span class="o">&lt;</span><span class="n">path</span> <span class="n">to</span> <span class="n">cn</span><span class="o">-</span><span class="n">ws</span> <span class="n">repository</span><span class="o">&gt;/</span><span class="n">cn_ws</span><span class="o">/</span><span class="n">docs</span><span class="o">/</span><span class="n">tutorials</span><span class="o">/</span><span class="n">tutorial_2</span><span class="o">.</span><span class="n">ini</span>
</pre></div>
</div>
<p>The following output rasters will emerge in the output folder:</p>
<ul class="simple">
<li><p><a class="reference internal" href="output.html#sediexportrst"><span class="std std-ref">SediExport_kg.rst</span></a>,</p></li>
<li><p><a class="reference internal" href="output.html#sedioutrst"><span class="std std-ref">SediOut_kg.rst</span></a>,</p></li>
<li><p><a class="reference internal" href="output.html#sediinrst"><span class="std std-ref">SediIn_kg.rst</span></a>,</p></li>
<li><p><a class="reference internal" href="output.html#watereroskgrst"><span class="std std-ref">WATEREROS (kg per gridcel).rst</span></a>,</p></li>
<li><p><a class="reference internal" href="output.html#watererosmmrst"><span class="std std-ref">WATEREROS (mm per gridcel).rst</span></a></p></li>
</ul>
<p>These rasters can help us to identify the spatial patterns of the soil erosion
and sediment deposition in the model area. The
<a class="reference internal" href="output.html#sediexportrst"><span class="std std-ref">SediExport_kg.rst</span></a> is a very useful raster when examining
the river locations with large sediment inputs. This raster shows
how much sediment enters every river pixel. Remember, the total amount of
sediment entering the rivers can be found in
<a class="reference internal" href="output.html#totalsedimenttxt"><span class="std std-ref">Total sediment.txt</span></a> (Sediment leaving the catchment,
via the river). This amount is in fact the sum of all river pixels in
SediExport_kg.rst.</p>
<p>If you want to see the paths of the sediment transport through the landscape,
you can look at <a class="reference internal" href="output.html#sedioutrst"><span class="std std-ref">SediOut_kg.rst</span></a> or
<a class="reference internal" href="output.html#sediinrst"><span class="std std-ref">SediIn_kg.rst</span></a>. These rasters display how much sediment
(in kg) is transported into and out of a cell.</p>
<p>The WATEREROS rasters can help with making a spatial analysis of areas where a lot of erosion occurs, or where a lot
of deposition is possible. These rasters
represent the result of the comparison between the total available sediment and
the trasport capacity of a pixel (for more information about this concept,
see <a class="reference internal" href="watem-sedem.html#concept"><span class="std std-ref">here</span></a>). Positive values in these rasters indicate deposition,
negative values indicate erosion. The
<a class="reference internal" href="output.html#totalsedimenttxt"><span class="std std-ref">Total sediment file</span></a>, discussed in the tutorial ‘1. A basic model run with WaTEM/SEDEM’,
contained the values ‘total erosion’ and ‘total deposition’. These values are
calculated as the sum of all pixels in the WATEREROS raster where the pixel
value is larger (deposition) or smaller (erosion) than zero.</p>
<p>If you want more spatial output, have a look in <a class="reference internal" href="output.html#modeloutput"><span class="std std-ref">the reference</span></a>
about all the possibilities!</p>
</div>
<div class="section" id="adding-buffer-basins">
<h2>3. Adding buffer basins<a class="headerlink" href="#adding-buffer-basins" title="Permalink to this heading"></a></h2>
<p>In the previous tutorials we learned how to make a model run with WS and how to
enable or disable model output. In this tutorial we will explain how to enable
one of the <em>advanced</em> features of CN-WS. The example will make use of the
<a class="reference internal" href="choices.html#includebuffers"><span class="std std-ref">Include Buffers</span></a> option, but the same principles can be
used for all other options!</p>
<p>Buffer basins are infrastructural features that trap sediment. As described in
<a class="reference internal" href="choices.html#includebuffers"><span class="std std-ref">the reference</span></a>. Two extra parameters are needed in the
ini-file if we want to enable this feature: the
<a class="reference internal" href="input.html#buffermap"><span class="std std-ref">buffer map filename</span></a> and  the
<a class="reference internal" href="input.html#nrbuffers"><span class="std std-ref">number of buffers</span></a>.</p>
<p>In this example we will add 31 buffers to the modelled catchment. After adding
the buffer map filename and the number of buffers the ini-file looks like this:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[Working directories]</span>
<span class="na">input directory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">../testfiles/molenbeek/modelinput/</span>
<span class="na">output directory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">../testfiles/molenbeek/modeloutput_tutorial_3/</span>

<span class="k">[Files]</span>
<span class="na">dtm filename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">dtm.rst</span>
<span class="na">p factor map filename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">P_molenbeek.rst</span>
<span class="na">parcel filename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">perceelskaart_2018_molenbeek_s1.rst</span>
<span class="na">c factor map filename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">C_spring_2018_molenbeek_s1.rst</span>
<span class="na">k factor filename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">K3_CNWS_molenbeek.rst</span>
<span class="hll"><span class="na">buffer map filename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">buffers_molenbeek_s1.rst</span>
</span>
<span class="k">[User Choices]</span>
<span class="na">only WS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1</span>
<span class="na">use r factor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1</span>
<span class="hll"><span class="na">include buffers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1</span>
</span>
<span class="k">[Variables]</span>
<span class="na">ktc low</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">3</span>
<span class="na">ktc high</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">12</span>
<span class="na">ktc limit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">0.01</span>
<span class="na">parcel connectivity cropland</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">90</span>
<span class="na">parcel connectivity forest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">30</span>
<span class="na">parcel trapping efficiency cropland</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">0</span>
<span class="na">parcel trapping efficiency forest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">75</span>
<span class="na">parcel trapping efficiency pasture</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">75</span>
<span class="na">bulk density</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1350</span>
<span class="na">r factor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1250</span>
<span class="hll"><span class="na">number of buffers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">31</span>
</span>
<span class="k">[Output maps]</span>
<span class="na">write sediment export</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1</span>
<span class="na">write water erosion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1</span>
</pre></div>
</div>
<p>If we run the model with this configuration (tutorial_3a.ini) we get:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CN_WS</span> <span class="n">model</span>

<span class="n">Inifile</span> <span class="p">:</span> <span class="o">&lt;</span><span class="n">path</span> <span class="n">to</span> <span class="n">inifile</span><span class="o">&gt;</span>\<span class="n">docs</span>\<span class="n">tutorials</span>\<span class="n">tutorial_3a</span><span class="o">.</span><span class="n">ini</span>

<span class="n">Error</span> <span class="ow">in</span> <span class="n">data</span> <span class="nb">input</span><span class="p">:</span> <span class="n">Buffer</span> <span class="mi">1</span> <span class="n">trapping</span> <span class="n">efficiency</span> <span class="n">value</span> <span class="n">missing</span> <span class="ow">or</span> <span class="n">wrong</span>
<span class="n">data</span> <span class="nb">format</span>
</pre></div>
</div>
<p>Oh no, an error has occured. What does this mean? This error indicates that
the input data in the configuration file is not correct. We read that the
trapping efficiency value of Buffer 1 is missing or is given in a wrong data
format. On the <a class="reference internal" href="choices.html#includebuffers"><span class="std std-ref">Model choices</span></a> page, more information can be found.
There, you find that we need to define the trapping
efficiency, the extension id and buffer id for every buffer in the configuration file (see
<a class="reference internal" href="input.html#bufferdata"><span class="std std-ref">here</span></a>). This has not yet been done here. So, we need to add 31 sections,
one for every buffer, with these data (see also tutorials/tutorial_3b.ini):</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[Working directories]</span>
<span class="na">input directory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">../testfiles/molenbeek/modelinput/</span>
<span class="na">output directory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">../testfiles/molenbeek/modeloutput_tutorial_3/</span>

<span class="k">[Files]</span>
<span class="na">dtm filename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">dtm.rst</span>
<span class="na">p factor map filename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">P_molenbeek.rst</span>
<span class="na">parcel filename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">perceelskaart_2018_molenbeek_s1.rst</span>
<span class="na">c factor map filename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">C_spring_2018_molenbeek_s1.rst</span>
<span class="na">k factor filename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">K3_CNWS_molenbeek.rst</span>
<span class="na">buffer map filename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">buffers_molenbeek_s1.rst</span>

<span class="k">[User Choices]</span>
<span class="na">only WS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1</span>
<span class="na">use r factor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1</span>
<span class="na">include buffers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1</span>

<span class="k">[Variables]</span>
<span class="na">ktc low</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">3</span>
<span class="na">ktc high</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">12</span>
<span class="na">ktc limit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">0.01</span>
<span class="na">parcel connectivity cropland</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">90</span>
<span class="na">parcel connectivity forest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">30</span>
<span class="na">parcel trapping efficiency cropland</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">0</span>
<span class="na">parcel trapping efficiency forest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">75</span>
<span class="na">parcel trapping efficiency pasture</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">75</span>
<span class="na">bulk density</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1350</span>
<span class="na">r factor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1250</span>
<span class="na">number of buffers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">31</span>

<span class="k">[Output maps]</span>
<span class="na">write sediment export</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1</span>
<span class="na">write water erosion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1</span>

<span class="k">[Buffer 1]</span>
<span class="na">trapping efficiency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">75</span>
<span class="na">extension id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">16385</span>

<span class="k">[Buffer 2]</span>
<span class="na">trapping efficiency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">75</span>
<span class="na">extension id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">16386</span>

<span class="k">[Buffer 3]</span>
<span class="na">trapping efficiency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">75</span>
<span class="na">extension id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">16387</span>

<span class="k">[Buffer 4]</span>
<span class="na">trapping efficiency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">75</span>
<span class="na">extension id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">16388</span>

<span class="k">[Buffer 5]</span>
<span class="na">trapping efficiency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">75</span>
<span class="na">extension id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">16389</span>

<span class="k">[Buffer 6]</span>
<span class="na">trapping efficiency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">75</span>
<span class="na">extension id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">16390</span>

<span class="k">[Buffer 7]</span>
<span class="na">trapping efficiency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">75</span>
<span class="na">extension id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">16391</span>

<span class="k">[Buffer 8]</span>
<span class="na">trapping efficiency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">75</span>
<span class="na">extension id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">16392</span>

<span class="k">[Buffer 9]</span>
<span class="na">trapping efficiency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">75</span>
<span class="na">extension id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">16393</span>

<span class="k">[Buffer 10]</span>
<span class="na">trapping efficiency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">75</span>
<span class="na">extension id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">16394</span>

<span class="k">[Buffer 11]</span>
<span class="na">trapping efficiency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">75</span>
<span class="na">extension id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">16395</span>

<span class="k">[Buffer 12]</span>
<span class="na">trapping efficiency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">75</span>
<span class="na">extension id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">16396</span>

<span class="k">[Buffer 13]</span>
<span class="na">trapping efficiency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">75</span>
<span class="na">extension id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">16397</span>

<span class="k">[Buffer 14]</span>
<span class="na">trapping efficiency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">75</span>
<span class="na">extension id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">16398</span>

<span class="k">[Buffer 15]</span>
<span class="na">trapping efficiency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">75</span>
<span class="na">extension id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">16399</span>

<span class="k">[Buffer 16]</span>
<span class="na">trapping efficiency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">75</span>
<span class="na">extension id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">16400</span>

<span class="k">[Buffer 17]</span>
<span class="na">trapping efficiency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">75</span>
<span class="na">extension id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">16401</span>

<span class="k">[Buffer 18]</span>
<span class="na">trapping efficiency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">75</span>
<span class="na">extension id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">16402</span>

<span class="k">[Buffer 19]</span>
<span class="na">trapping efficiency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">75</span>
<span class="na">extension id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">16403</span>

<span class="k">[Buffer 20]</span>
<span class="na">trapping efficiency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">75</span>
<span class="na">extension id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">16404</span>

<span class="k">[Buffer 21]</span>
<span class="na">trapping efficiency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">75</span>
<span class="na">extension id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">16405</span>

<span class="k">[Buffer 22]</span>
<span class="na">trapping efficiency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">75</span>
<span class="na">extension id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">16406</span>

<span class="k">[Buffer 23]</span>
<span class="na">trapping efficiency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">75</span>
<span class="na">extension id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">16407</span>

<span class="k">[Buffer 24]</span>
<span class="na">trapping efficiency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">75</span>
<span class="na">extension id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">16408</span>

<span class="k">[Buffer 25]</span>
<span class="na">trapping efficiency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">75</span>
<span class="na">extension id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">16409</span>

<span class="k">[Buffer 26]</span>
<span class="na">trapping efficiency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">75</span>
<span class="na">extension id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">16410</span>

<span class="k">[Buffer 27]</span>
<span class="na">trapping efficiency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">75</span>
<span class="na">extension id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">16411</span>

<span class="k">[Buffer 28]</span>
<span class="na">trapping efficiency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">75</span>
<span class="na">extension id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">16412</span>

<span class="k">[Buffer 29]</span>
<span class="na">trapping efficiency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">75</span>
<span class="na">extension id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">16413</span>

<span class="k">[Buffer 30]</span>
<span class="na">trapping efficiency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">75</span>
<span class="na">extension id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">16414</span>

<span class="k">[Buffer 31]</span>
<span class="na">trapping efficiency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">75</span>
<span class="na">extension id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">16415</span>
</pre></div>
</div>
<p>A buffer should trap sediment. So, after a successful model run with the above given ini-file, we
can look at the Total sediment file in the output folder, to see that the ‘<em>sediment trapped in buffers</em>’ line is added.</p>
<div class="highlight-vim notranslate"><div class="highlight"><pre><span></span>Total erosion: <span class="m">-21944111</span>.<span class="m">28</span> <span class="p">(</span>kg<span class="p">)</span>
Total deposition: <span class="m">17805814</span>.<span class="m">73</span> <span class="p">(</span>kg<span class="p">)</span>
Sediment leaving the catchment<span class="p">,</span> via the river: <span class="m">3165519</span>.<span class="m">57</span> <span class="p">(</span>kg<span class="p">)</span>
Sediment leaving the catchment<span class="p">,</span> not via the river: <span class="m">419793</span>.<span class="m">77</span> <span class="p">(</span>kg<span class="p">)</span>
<span class="hll">Sediment trapped <span class="k">in</span> <span class="k">buffers</span>: <span class="m">543950</span>.<span class="m">23</span> <span class="p">(</span>kg<span class="p">)</span>
</span>_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

Total sediment passing at each outlet [kg]
Outlet ID	Sediment
<span class="m">1</span>	<span class="m">3165518</span>.<span class="m">25</span>
</pre></div>
</div>
<p>This line gives us the total amount of sediment trapped in the 31
buffer basins added to the model. We also see that the amount of sediment
that reached the river (Sediment leaving the catchment, via the river) is less
in this model run than in the previous model run (see <a class="reference internal" href="#tutsection1"><span class="std std-ref">section 1</span></a>). We can conclude that the addition
of buffers in this model run is a good measure to reduce the sediment input
in the rivers.</p>
</div>
<div class="section" id="use-the-cn-module">
<h2>4. Use the CN module<a class="headerlink" href="#use-the-cn-module" title="Permalink to this heading"></a></h2>
<p>To use the complete CN-WS model, we need to disable the
<a class="reference internal" href="choices.html#simple"><span class="std std-ref">Only WS option</span></a> we used in the previous tutorials.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[User Choices]</span>
<span class="na">Only WS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">0</span>
</pre></div>
</div>
<p>Using the CN-part implies we need to define additional input in the ini-file.
At the bottom of the <a class="reference internal" href="choices.html#simple"><span class="std std-ref">Only WS</span></a>, the mandatory input is for running the full CN-WS model is described. We extend
the ini-file with this input:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[Files]</span>
<span class="na">...</span>
<span class="na">cn map filename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">CNmap.rst</span>
<span class="na">rainfall filename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">LS09_15B_N_event_1_dummy.txt</span>
<span class="na">...</span>
<span class="k">[Variables]</span>
<span class="na">...</span>
<span class="na">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">0.4</span>
<span class="na">beta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">0.05</span>
<span class="na">stream velocity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">0.3</span>
<span class="na">5-day antecedent rainfall</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">0</span>
<span class="na">desired timestep for model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">60</span>
<span class="na">endtime model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">2940</span>
<span class="na">...</span>
</pre></div>
</div>
<p>The CN module will create some additional <a class="reference internal" href="output.html#cnoutput"><span class="std std-ref">output</span></a>. Most output is
automatically generated by enabling the CN module, however, it is posible to write
an extra output raster, namely, the ‘rainfall excess’ raster (Remap.rst). This can be done by adding following line to the ini-file:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[Output maps]</span>
<span class="na">...</span>
<span class="na">write rainfall excess</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1</span>
<span class="na">...</span>
</pre></div>
</div>
<p>We refer to the documentation about CN for the interpretation of the output.</p>
</div>
<div class="section" id="more-examples">
<h2>5. More examples?<a class="headerlink" href="#more-examples" title="Permalink to this heading"></a></h2>
<p>Do you want to experiment even more with the options of CN-WS? The test files
in the repository contain an example project where following options are used:</p>
<ul class="simple">
<li><p>river routing</p></li>
<li><p>include ditches</p></li>
<li><p>include sewers</p></li>
<li><p>create ktc map = 0</p></li>
<li><p>…</p></li>
</ul>
<p>Have a look at them, and using the principles explained above you should be able to get these
working!</p>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="installation.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="faq.html" class="btn btn-neutral float-right" title="Frequently Asked Questions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Van de Wauw Johan, Renders Daan.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>